<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">Modern Times</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent"> The Tramp struggles to live in modern industrial society with the help of a young homeless woman. Chaplin's last 'silent' film, filled with sound effects, was made when everyone else was making talkies. Charlie turns against modern society, the machine age, (The use of sound in films ?) and progress. Firstly we see him frantically trying to keep up with a production line, tightening bolts. He is selected for an experiment with an automatic feeding machine, but various mishaps leads his boss to believe he has gone mad, and Charlie is sent to a mental hospital - When he gets out, he is mistaken for a communist while waving a red flag, sent to jail, foils a jailbreak, and is let out again. We follow Charlie through many more escapades before t... </span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <span id="metaPlotContent"class="additional-information"> he film is out. Colin Tinto  The idea of the film was apparently given to Chaplin by a young reporter, who told him about the production line system in Detroit, which was turning its workers into nervous wrecks. In the film, Charlie becomes literally trapped in the machine and, in one of his finest patches of comic invention, is battered and buffeted by an automatic feeding machine introduced by his bosses to save time and money. Cured after his breakdown, he is arrested when he picks up a red flag that has fallen off the back of a lorry, and runs down the street to return it, exactly the same time as a left-wing demonstration comes round the corner. He meets 'The Gamine' in the back of the police van, who has also been arrested for stealing bread. From then on the theme is about two nondescripts trying to get along in modern times.  Smile, though your heart is breaking ...  alfiehitchie A little tramp is finding it difficult to match his own sensibilities to the modern mechanized world. Failing as a worker on a factory assembly line, he gets into a series of adventures and misadventures, which leads to him meeting a young recently orphaned gamine who ran away rather than end up in an orphanage. They try to survive in the world together, both on the run from the law, although his previous stints behind bars were to him more comforting than life outside in the cold modern world. Beyond being wanted by the law, the question becomes whether they individually or together can find their proper place in the ever changing world which seems out to get them. Huggo The story begins on the life of a factory working who is employed on the assembly line. His job sees him screwing nuts at an ever-increasing rate as part of the assembly line as well as being subjected to new, untested inventions like an 'automatic feeding machine'. This daily monotony pushes him over the edge and, after a lengthy stay in an asylum, is arrested for being mistakenly taken as an instigator at a communist rally. What follows is the factory worker meeting the love of his life, taking on several new jobs and trying to make what proves to be a difficult living. Kyle Perez </span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                           id="myCollapsibleBtn"
                                                           role="button"></a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BYjJiZjMzYzktNjU0NS00OTkxLWEwYzItYzdhYWJjN2QzMTRlL2ltYWdlL2ltYWdlXkEyXkFqcGdeQXVyNjU0OTQ0OTY@.jpg"
                                             class="img-fluid rounded-start"
                                             alt="Modern Times"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Sierra Highway and Penman Road, Santa Clarita, California 91390, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.5215271</span>, <span class="lon">-118.2645085</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Los Angeles Harbor College, 1111 Figueroa Pl, Wilmington, California 90744, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.7842845</span>, <span class="lon">-118.283979</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Los Angeles, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.053691</span>, <span class="lon">-118.242766</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Santa Clarita, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.445723</span>, <span class="lon">-118.523461</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">San Pedro Harbor, Wilmington, California 90744, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.761755</span>, <span class="lon">-118.283373</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">1416 La Brea Avenue, Los Angeles, California 90019, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.04724</span>, <span class="lon">-118.34451</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Center Street and E Jackson St, Los Angeles, California 90012, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.0508672</span>, <span class="lon">-118.2316134</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">10858 Bluffside Drive, Studio City, California 91604, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.14054</span>, <span class="lon">-118.36683</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">1685 Vine Street, Los Angeles, California 90038, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.08563</span>, <span class="lon">-118.326612</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">South Wilmington Avenue, Compton, California 90220, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.87155</span>, <span class="lon">-118.23678</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">N San Pedro St, Los Angeles, California 90012, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.05316</span>, <span class="lon">-118.23942</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Brentwood, Los Angeles, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.05214</span>, <span class="lon">-118.47407</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">The Standard, 8300 W Sunset Blvd, Los Angeles, California 90069, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.095892</span>, <span class="lon">-118.37094</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Los Angeles, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.053691</span>, <span class="lon">-118.242766</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Long Beach, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.769016</span>, <span class="lon">-118.191604</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.0743595873</span>, <span class="lon">-119.699375153073</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">39.3812661305678</span>, <span class="lon">-97.9222112121185</span></a>
                            </td>
                        </tr>
                    </table>
            </div>
        </main>
        <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>
        <script type="text/javascript">
var locations =[{"bbox": [[33.761755, -118.283373], [33.769016, -118.191604], [33.7842845, -118.283979]], "data": [{"lat": 34.5215271, "lon": -118.2645085, "name": "Sierra Highway and Penman Road, Santa Clarita, California 91390, United States"}, {"lat": 33.7842845, "lon": -118.283979, "name": "Los Angeles Harbor College, 1111 Figueroa Pl, Wilmington, California 90744, United States"}, {"lat": 34.053691, "lon": -118.242766, "name": "Los Angeles, California, United States"}, {"lat": 34.445723, "lon": -118.523461, "name": "Santa Clarita, California, United States"}, {"lat": 33.761755, "lon": -118.283373, "name": "San Pedro Harbor, Wilmington, California 90744, United States"}, {"lat": 34.04724, "lon": -118.34451, "name": "1416 La Brea Avenue, Los Angeles, California 90019, United States"}, {"lat": 34.0508672, "lon": -118.2316134, "name": "Center Street and E Jackson St, Los Angeles, California 90012, United States"}, {"lat": 34.14054, "lon": -118.36683, "name": "10858 Bluffside Drive, Studio City, California 91604, United States"}, {"lat": 34.08563, "lon": -118.326612, "name": "1685 Vine Street, Los Angeles, California 90038, United States"}, {"lat": 33.87155, "lon": -118.23678, "name": "South Wilmington Avenue, Compton, California 90220, United States"}, {"lat": 34.05316, "lon": -118.23942, "name": "N San Pedro St, Los Angeles, California 90012, United States"}, {"lat": 34.05214, "lon": -118.47407, "name": "Brentwood, Los Angeles, California, United States"}, {"lat": 34.095892, "lon": -118.37094, "name": "The Standard, 8300 W Sunset Blvd, Los Angeles, California 90069, United States"}, {"lat": 34.053691, "lon": -118.242766, "name": "Los Angeles, California, United States"}, {"lat": 33.769016, "lon": -118.191604, "name": "Long Beach, California, United States"}, {"lat": 37.0743595873, "lon": -119.699375153073, "name": "California, United States"}, {"lat": 39.3812661305678, "lon": -97.9222112121185, "name": "United States"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                          
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
        </script>
    </body>
</html>