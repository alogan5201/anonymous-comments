<!DOCTYPE html>
<html lang="en" dir="ltr">
<%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>

  <body class="film-location">
    <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
    <![endif]-->

    <noscript>
      <h3>Please enable JavaScript in order to view this site properly.</h3>
    </noscript>

    <%- include(`${partials}/nav`); -%>

     <main class="mb-4 mt-5">



        <div class="container px-4 px-lg-5">


            <div class="row align-items-md-stretch">
                
              <div class="col-md-12">

                <div class="card mb-3" id="film-details">
                  <div class="row g-0">
                    <div class="col-md-8 px-3 py-3">
                      <div class="card-body">
                      <h3 class="card-title">The Batman</h3>
          <p class="card-text mb-0">


  <span > When the Riddler, a sadistic serial killer, begins murdering key political figures in Gotham, Batman is forced to investigate the city's hidden corruption and question his family's involvement.  </span>
                          

                        </p>
                      </div>
                    </div>
                      <div class="col-md-4 justify-self-end">
                      <img
                                      src="https://m.media-amazon.com/images/M/MV5BMDdmMTBiNTYtMDIzNi00NGVlLWIzMDYtZTk3MTQ3NGQxZGEwXkEyXkFqcGdeQXVyMzMwOTU5MDk@.jpg"
                                      class="img-fluid rounded-start"
                                      alt="The Batman"
                                    />
                    </div>
                     </div>
                </div>
              </div>
            </div>
          
            <div class="col-lg-12">
  <div class="map-container">
                  <div id="map"></div>
                  <div id="loader">
                    <div class="spinner-border" role="status">
                      <span class="sr-only d-none">Loading...</span>
                    </div>
                  </div>
                </div>

            </div>

 <table class="table">
          <tr class="table__header">

            <th class="table__cell">Location</th>
           <th class="table__cell">Coordiantes</th>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">St George's Hall, St George's Pl, Liverpool, England L1 1JJ, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">53.4086245</span>, <span class="lon">-2.980103</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Glasgow Necropolis, Wishart St, Glasgow, Scotland G31 2AA, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">55.862627</span>, <span class="lon">-4.232136499999999</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Surrey Quays Road, Southwark, London, SE16 7BG, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.497144</span>, <span class="lon">-0.050757</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Hartwood, North Lanarkshire, Scotland, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">55.8113</span>, <span class="lon">-3.8387</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Liverpool, Merseyside, England, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">53.407154</span>, <span class="lon">-2.991665</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Walker Art Gallery, William Brown St, Liverpool, England L3 8EL, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">53.409957</span>, <span class="lon">-2.9795730000000002</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">England, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">52.38145972</span>, <span class="lon">-0.676181762467007</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">London, Greater London, England, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.507321899999994</span>, <span class="lon">-0.12764739999999997</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Anfield Cemetery, Priory Rd., Liverpool, England L4 2SL, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">53.4378575</span>, <span class="lon">-2.9580735000000002</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Royal Liver Building, Pier Head, Liverpool, England L3 1PY, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">53.405811</span>, <span class="lon">-2.99608</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Airship Hangar, Farnborough, England GU14 7JP, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.28478</span>, <span class="lon">-0.760758</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">230 S La Salle St, Chicago, Illinois 60604, United States </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">41.8785</span>, <span class="lon">-87.632696</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Two Temple Place, 2 Temple Pl, London, England WC2R 3BD, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.5115615</span>, <span class="lon">-0.112318</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Wishart Street, Glasgow, G31 2HT, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">55.864935</span>, <span class="lon">-4.230782</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">Warner Bros. Studios Leavesden, Warner Dr, Watford, England WD25 7LP, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.69323</span>, <span class="lon">-0.4184505</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">St. Martin's, CT1 1PY, Canterbury, Kent, England, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.2781407</span>, <span class="lon">1.0948644</span></a>
                
            </td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">
             <a href="#">O2, Units 1.02 & 1.03 The O2 Millennium Way, London, England SE10 0DY, United Kingdom </a>
               
            </td>
                <td class="table__cell">
                <a href="#"><span class="lat">51.502822125</span>, <span class="lon">0.0032571874999999997</span></a>
                
            </td>
          </tr>
          </tr>

        </table>
          </div>
        </div>


    </main>



     <%- include(`${partials}/footer`); -%> <%-include(`${partials}/homeScripts`); -%>

  <script type="text/javascript">

var locations =[{"bbox": [[51.28478, -0.760758], [51.497144, -0.050757], [51.502822125, 0.0032571874999999997]], "data": [{"lat": 53.4086245, "lon": -2.980103, "name": "St George\u0027s Hall, St George\u0027s Pl, Liverpool, England L1 1JJ, United Kingdom"}, {"lat": 55.862627, "lon": -4.232136499999999, "name": "Glasgow Necropolis, Wishart St, Glasgow, Scotland G31 2AA, United Kingdom"}, {"lat": 51.497144, "lon": -0.050757, "name": "Surrey Quays Road, Southwark, London, SE16 7BG, United Kingdom"}, {"lat": 55.8113, "lon": -3.8387, "name": "Hartwood, North Lanarkshire, Scotland, United Kingdom"}, {"lat": 53.407154, "lon": -2.991665, "name": "Liverpool, Merseyside, England, United Kingdom"}, {"lat": 53.409957, "lon": -2.9795730000000002, "name": "Walker Art Gallery, William Brown St, Liverpool, England L3 8EL, United Kingdom"}, {"lat": 52.38145972, "lon": -0.676181762467007, "name": "England, United Kingdom"}, {"lat": 51.507321899999994, "lon": -0.12764739999999997, "name": "London, Greater London, England, United Kingdom"}, {"lat": 53.4378575, "lon": -2.9580735000000002, "name": "Anfield Cemetery, Priory Rd., Liverpool, England L4 2SL, United Kingdom"}, {"lat": 53.405811, "lon": -2.99608, "name": "Royal Liver Building, Pier Head, Liverpool, England L3 1PY, United Kingdom"}, {"lat": 51.28478, "lon": -0.760758, "name": "Airship Hangar, Farnborough, England GU14 7JP, United Kingdom"}, {"lat": 41.8785, "lon": -87.632696, "name": "230 S La Salle St, Chicago, Illinois 60604, United States"}, {"lat": 51.5115615, "lon": -0.112318, "name": "Two Temple Place, 2 Temple Pl, London, England WC2R 3BD, United Kingdom"}, {"lat": 55.864935, "lon": -4.230782, "name": "Wishart Street, Glasgow, G31 2HT, United Kingdom"}, {"lat": 51.69323, "lon": -0.4184505, "name": "Warner Bros. Studios Leavesden, Warner Dr, Watford, England WD25 7LP, United Kingdom"}, {"lat": 51.2781407, "lon": 1.0948644, "name": "St. Martin\u0027s, CT1 1PY, Canterbury, Kent, England, United Kingdom"}, {"lat": 51.502822125, "lon": 0.0032571874999999997, "name": "O2, Units 1.02 \u0026 1.03 The O2 Millennium Way, London, England SE10 0DY, United Kingdom"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
    //console.log($(`${target} span`).first())

   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
</script>
  </body>
</html>