<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                     <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">All About Eve</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent">A seemingly timid but secretly ruthless ingénue insinuates herself into the lives of an aging Broadway star and her circle of theater friends. Eve Harrington (Anne Baxter) is waiting backstage to meet her idol, talented but aging Broadway star Margo Channing (Bette Davis). It seems innocent enough as Eve explains that she has seen Margo in EVERY performance of her current play. Margo and her friends take Eve under their wing but only theatre critic Addison DeWitt (George Sanders) sees through Eve's evil plan, which is to take Margo's parts and her fiancé, Bill Simpson (Gary Merrill) too. Backstage story revolving around aspiring actress Eve Harrington. Tattered and forlorn, Eve shows up in the dressing room of Broadway mega-star Margo Chann...</span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <div id = "module"></div>
                                                        <span id="metaPlotContent"class="additional-information">ing and tells Margo and her friends a melancholy life story. Margo takes Eve under her wing, only to have Eve use her and connive against her. Jwelch5742 Aspiring actress Eve Harrington maneuvers her way into the lives of Broadway star Margo Channing, playwright Lloyd Richards, and director Bill Simpson. This classic story of ambition and betrayal has become part of American folklore. Bette Davis claims to have based her character on the persona of film actress Tallulah Bankhead. Davis' line  Fasten your seatbelts, it's going to be a bumpy night  is legendary, but all of the film's dialogue sparkles with equal brilliance. Jeanne Baker <jbaker@erim.org> The ambitious Eve Harrington gets close to the great and temperamental stage artist Margo Channing and her friends Karen Richards and her playwright husband Lloyd Richards, her director boyfriend Bill Simpson, and producer Max Fabian. Everybody except cynical critic Addison DeWitt believes that Eve is simply a naïve, obsessed Margo fan and they try to help her. Actually, Eve is a cynical, manipulative snake that uses the lives of Margo and her friends to reach her show- business goals. Claudio Carvalho, Rio de Janeiro, Brazil Stage star Margo Channing is friend to playwright Lloyd Richards and his wife Karen, in love with director Bill Simpson, and the idol of Eve Harrington. When Eve becomes Margo's secretary-aide, she starts to dominate, sending Bill Margo's birthday wishes and arranging a party for him, at which Margo explodes. Eve becomes Margo's understudy and when Margo misses a performance, critic Addison DeWitt gives Eve rave reviews while making acerbic remarks about aging actresses like Margo. At Margo and Bill's engagement party Eve tries to force Karen to get her the lead in Lloyd's new play. Margo tells Lloyd she is going to retire. Eve gets the part but Addison announces to her that he knows the lies and schemes she used to get where she is. Ed Stephan <stephan@cc.wwu.edu></span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                               id="myCollapsibleBtn"
                                                      
                                                           role="button"
                                                       >
                                                        </a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BMTY2MTAzODI5NV5BMl5BanBnXkFtZTgwMjM4NzQ0MjE@.jpg"
                                             class="img-fluid rounded-start"
                                             alt="All About Eve"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">San Francisco, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.779026</span>, <span class="lon">-122.419906</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">21 West 52nd Street, New York, New York 10019, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">40.76037</span>, <span class="lon">-73.97741</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">252 West 45th Street, New York, New York 10036, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">40.75885</span>, <span class="lon">-73.98792</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">247 College Street, New Haven, Connecticut 06510, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">41.30639</span>, <span class="lon">-72.92924</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">10201 West Pico Boulevard, Los Angeles, California 90064, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.04994</span>, <span class="lon">-118.41129</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">242 West 45th Street, New York, New York 10036, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">40.75868</span>, <span class="lon">-73.987685</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">The Study at Yale Hotel, 1157 Chapel St, New Haven, Connecticut 06511, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">41.308822</span>, <span class="lon">-72.932938</span></a>
                            </td>
                        </tr>
                    </tr>
            </table>
        </div>
    </div>
</main>
    <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>

<script type="text/javascript">
var locations =[{"bbox": [[40.75868, -73.987685], [40.75885, -73.98792], [40.76037, -73.97741]], "data": [{"lat": 37.779026, "lon": -122.419906, "name": "San Francisco, California, United States"}, {"lat": 40.76037, "lon": -73.97741, "name": "21 West 52nd Street, New York, New York 10019, United States"}, {"lat": 40.75885, "lon": -73.98792, "name": "252 West 45th Street, New York, New York 10036, United States"}, {"lat": 41.30639, "lon": -72.92924, "name": "247 College Street, New Haven, Connecticut 06510, United States"}, {"lat": 34.04994, "lon": -118.41129, "name": "10201 West Pico Boulevard, Los Angeles, California 90064, United States"}, {"lat": 40.75868, "lon": -73.987685, "name": "242 West 45th Street, New York, New York 10036, United States"}, {"lat": 41.308822, "lon": -72.932938, "name": "The Study at Yale Hotel, 1157 Chapel St, New Haven, Connecticut 06511, United States"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
    //console.log($(`${target} span`).first())

   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
</script>
</body>
</html>