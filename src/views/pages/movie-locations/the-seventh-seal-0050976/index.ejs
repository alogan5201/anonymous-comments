<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">The Seventh Seal</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent"> A knight returning to Sweden after the Crusades seeks answers about life, death, and the existence of God as he plays chess against the Grim Reaper during the Black Plague. A Knight and his squire are home from the crusades. Black Death is sweeping their country. As they approach home, Death appears to the knight and tells him it is his time. The knight challenges Death to a chess game for his life. The Knight and Death play as the cultural turmoil envelopes the people around them as they try, in different ways, to deal with the upheaval the plague has caused. John Vogel  Returning home from the Crusades, Swedish knight Antonius Block and his squire Jöns find the land ravaged by the plague. Block finds that people everywhere are living in f... </span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <span id="metaPlotContent"class="additional-information"> ear believing it is God's punishment and that the end has come. Block has lost his faith and is looking for answers so when Death comes for him the knight challenges him to a game of chess. The countryside is bleak and many search for answers though none seem to be found. Block makes it to his home and believes he has the upper hand - but Death will have his way. garykmcd In medieval times, Antonius Block, a knight, and his squire Jöns have just returned to their Swedish homeland after fighting in the Crusades, only to find the plague ravishing their country. In their travels toward home, Antonius, without Jöns' knowledge, comes across the personification of Death, who wants to take Antonius' life. Antonius has long felt Death's presence around him. As he feels he has more to do in his life, Antonius challenges Death to a chess match, the outcome which will determine Antonius' fate and that of others around him with regard to Death. Because of what has happened around him, Antonius has lost faith in God, and instead is looking for knowledge in why things happen. He feels he has one more important act in his life before he dies. In his continuing chess match and their trek toward home, Antonius and Jöns stumble across an acting troupe, who are performing among others a passion play. Antonius offers them safer travels with him and Jöns through the forest to his castle to avoid the plague. His time with the troupe may provide Antonius with some of those answers for which he is looking, especially his encounters with husband and wife, Jof and Mia, and their infant son, Mikael. Huggo Max Von Sydow stars as a 14th century knight named Antonius Block, wearily heading home after ten years' worth of combat. Disillusioned by unending war, plague, and misery Block has concluded that God does not exist. As he trudges across the wilderness, Block is visited by Death (Bengt Ekerot), garbed in the traditional black robe. Unwilling to give up the ghost, Block challenges Death to a game of chess. If he wins, he lives -- if not, he'll allow Death to claim him. When disillusioned Swedish knight Antonius Block returns home from the Crusades to find his country in the grips of the Black Death, he challenges Death to a chess match for his life. Tormented by the belief that God does not exist, Block sets off on a journey, meeting up with traveling players Jof and his wife, Mia, and becoming determined to evade Death long enough to commit one redemptive act while he still lives. hassaanahmed-96661 </span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                           id="myCollapsibleBtn"
                                                           role="button"></a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BOWM3MmE0OGYtOGVlNC00OWE1LTk5ZTAtYmUwMDIwM2ZlNWJiXkEyXkFqcGdeQXVyMjUzOTY1NTc@.jpg"
                                             class="img-fluid rounded-start"
                                             alt="The Seventh Seal"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Hovs Hallar Hotell, Båstad, Skåne 269 91, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">56.467873</span>, <span class="lon">12.708134</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Värmdö, Stockholm, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.318372</span>, <span class="lon">18.472152</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Solna, Stockholm, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.361367</span>, <span class="lon">18.001369</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Vibyvägen, 193 35 Sigtuna, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.6327327936475</span>, <span class="lon">17.732220181168</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Solna, Stockholm, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.361367</span>, <span class="lon">18.001369</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Filmstaden Råsunda, Greta garbos väg 11,13, Solna, Stockholm 169 40, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.367224</span>, <span class="lon">17.981759</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Loén, Rådmansgatan 23, Stockholm, Stockholm 114 25, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.342707</span>, <span class="lon">18.065871</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Gustavsberg, Stockholm, Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">59.325624</span>, <span class="lon">18.388514</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Sweden</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">64.9648751621697</span>, <span class="lon">17.6754094331351</span></a>
                            </td>
                        </tr>
                    </table>
            </div>
        </main>
        <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>
        <script type="text/javascript">
var locations =[{"bbox": [[59.318372, 18.472152], [59.325624, 18.388514], [59.342707, 18.065871]], "data": [{"lat": 56.467873, "lon": 12.708134, "name": "Hovs Hallar Hotell, B\u00e5stad, Sk\u00e5ne 269 91, Sweden"}, {"lat": 59.318372, "lon": 18.472152, "name": "V\u00e4rmd\u00f6, Stockholm, Sweden"}, {"lat": 59.361367, "lon": 18.001369, "name": "Solna, Stockholm, Sweden"}, {"lat": 59.6327327936475, "lon": 17.732220181168, "name": "Vibyv\u00e4gen, 193 35 Sigtuna, Sweden"}, {"lat": 59.361367, "lon": 18.001369, "name": "Solna, Stockholm, Sweden"}, {"lat": 59.367224, "lon": 17.981759, "name": "Filmstaden R\u00e5sunda, Greta garbos v\u00e4g 11,13, Solna, Stockholm 169 40, Sweden"}, {"lat": 59.342707, "lon": 18.065871, "name": "Lo\u00e9n, R\u00e5dmansgatan 23, Stockholm, Stockholm 114 25, Sweden"}, {"lat": 59.325624, "lon": 18.388514, "name": "Gustavsberg, Stockholm, Sweden"}, {"lat": 64.9648751621697, "lon": 17.6754094331351, "name": "Sweden"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                          
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
        </script>
    </body>
</html>