<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                     <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">Ford v Ferrari</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent">American car designer Carroll Shelby and driver Ken Miles battle corporate interference and the laws of physics to build a revolutionary race car for Ford in order to defeat Ferrari at the 24 Hours of Le Mans in 1966. As Enzo Ferrari's fast Rosso-Corsa racing cars dominate the mid-1960s motorsport world, the American car designer, Carroll Shelby, is forced to retire after winning the demanding 1959 '24 Hours of Le Mans' endurance race. But, before long, an unexpected proposition by the Vice President of Henry Ford's motor company, Lee Iacocca, will offer an opportunity to beat the Italians at their own game. Now, under those pressing circumstances, the British sports car driver and racing engineer, Ken Miles, reluctantly agrees to lend a ha...</span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <div id = "module"></div>
                                                        <span id="metaPlotContent"class="additional-information">nd and improve the firm's image, as Ford's race team has less than ninety days to rewrite history. As a result, the non-conformist duo comes up with the mighty Ford GT40 Mk I high-performance racing car. Can Shelby and Miles break Ferrari's streak? Nick Riganas American automotive designer Carroll Shelby and British race car driver Ken Miles compete in a fierce corporate battle as well as nature itself,to build a vehicle for the Ford automobiles. Together, they plan to compete against the race cars of Enzo Ferrari at the 24 Hours of Le Mans in France in 1966. Jwelch5742 Ford Company has a big problem in selling its cars in the 1960s. They decide to take part in 24 Hours of Le Mans endurance race to show and advertise their cars. Ferrari's fast racing cars dominate the mid-60s racing world. Ford's advertisement team request Carrol Shelby to build fast cars for the race. Shelby asks British driver and racing engineer, Ken Miles to be the main driver for Ford's company in the race.</span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                               id="myCollapsibleBtn"
                                                      
                                                           role="button"
                                                       >
                                                        </a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BM2UwMDVmMDItM2I2Yi00NGZmLTk4ZTUtY2JjNTQ3OGQ5ZjM2XkEyXkFqcGdeQXVyMTA1OTYzOTUx.jpg"
                                             class="img-fluid rounded-start"
                                             alt="Ford v Ferrari"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Savannah, Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">32.080926</span>, <span class="lon">-81.091177</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Willow Springs, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.84706</span>, <span class="lon">-118.569828</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">6311 Meridian Avenue, Los Angeles, California 90042, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.12023</span>, <span class="lon">-118.17877</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">645 Avenue 64, Los Angeles, California 90042, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.11998</span>, <span class="lon">-118.17846</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Fontana, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.092234</span>, <span class="lon">-117.435048</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Statesboro, Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">32.449014</span>, <span class="lon">-81.783291</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Road Atlanta, 5300 Winder Hwy, Braselton, Georgia 30517, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.150789</span>, <span class="lon">-83.81415</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Los Angeles, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.053691</span>, <span class="lon">-118.242766</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Glendale, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.146942</span>, <span class="lon">-118.247847</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Ontario, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.065846</span>, <span class="lon">-117.64843</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">33638 Agua Dulce Canyon Road, Agua Dulce, California 91390, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.50006</span>, <span class="lon">-118.32424</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">North Brand Boulevard and West Dryden Street, Glendale, California 91202, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.161457</span>, <span class="lon">-118.255091</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Ontario, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.065846</span>, <span class="lon">-117.64843</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">32.3305706594</span>, <span class="lon">-83.2572560296474</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Fontana, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.092234</span>, <span class="lon">-117.435048</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.0743595873</span>, <span class="lon">-119.699375153073</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">39.3812661305678</span>, <span class="lon">-97.9222112121185</span></a>
                            </td>
                        </tr>
                    </tr>
            </table>
        </div>
    </div>
</main>
    <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>

<script type="text/javascript">
var locations =[{"bbox": [[34.053691, -118.242766], [34.065846, -117.64843], [34.065846, -117.64843]], "data": [{"lat": 32.080926, "lon": -81.091177, "name": "Savannah, Georgia, United States"}, {"lat": 34.84706, "lon": -118.569828, "name": "Willow Springs, California, United States"}, {"lat": 34.12023, "lon": -118.17877, "name": "6311 Meridian Avenue, Los Angeles, California 90042, United States"}, {"lat": 34.11998, "lon": -118.17846, "name": "645 Avenue 64, Los Angeles, California 90042, United States"}, {"lat": 34.092234, "lon": -117.435048, "name": "Fontana, California, United States"}, {"lat": 32.449014, "lon": -81.783291, "name": "Statesboro, Georgia, United States"}, {"lat": 34.150789, "lon": -83.81415, "name": "Road Atlanta, 5300 Winder Hwy, Braselton, Georgia 30517, United States"}, {"lat": 34.053691, "lon": -118.242766, "name": "Los Angeles, California, United States"}, {"lat": 34.146942, "lon": -118.247847, "name": "Glendale, California, United States"}, {"lat": 34.065846, "lon": -117.64843, "name": "Ontario, California, United States"}, {"lat": 34.50006, "lon": -118.32424, "name": "33638 Agua Dulce Canyon Road, Agua Dulce, California 91390, United States"}, {"lat": 34.161457, "lon": -118.255091, "name": "North Brand Boulevard and West Dryden Street, Glendale, California 91202, United States"}, {"lat": 34.065846, "lon": -117.64843, "name": "Ontario, California, United States"}, {"lat": 32.3305706594, "lon": -83.2572560296474, "name": "Georgia, United States"}, {"lat": 34.092234, "lon": -117.435048, "name": "Fontana, California, United States"}, {"lat": 37.0743595873, "lon": -119.699375153073, "name": "California, United States"}, {"lat": 39.3812661305678, "lon": -97.9222112121185, "name": "United States"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
    //console.log($(`${target} span`).first())

   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
</script>
</body>
</html>