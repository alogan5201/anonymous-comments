<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                     <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">Avengers: Infinity War</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent">The Avengers and their allies must be willing to sacrifice all in an attempt to defeat the powerful Thanos before his blitz of devastation and ruin puts an end to the universe. As the Avengers and their allies have continued to protect the world from threats too large for any one hero to handle, a new danger has emerged from the cosmic shadows: Thanos. A despot of intergalactic infamy, his goal is to collect all six Infinity Stones, artifacts of unimaginable power, and use them to inflict his twisted will on all of reality. Everything the Avengers have fought for has led up to this moment, the fate of Earth and existence has never been more uncertain. Marvel Studios Now that Earth has put its mark on the universe through the Avengers, all s...</span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <div id = "module"></div>
                                                        <span id="metaPlotContent"class="additional-information">uperheroes, including ones from other parts of the Galaxy, must join forces to stop the powerful Thanos from taking all the infinity stones and destroying the universe one planet at a time. Joshua Chandler The mad titan Thanos (Josh Brolin) begins his hunt for the most powerful objects in the universe, the Infinity Stones, in this movie. With the Space Stone, given by Loki (Tom Hiddleston), and the Power Stone, Thanos sends (Ebony Maw, Cull Obsidian to retrieve the Time Stone from Doctor Strange (Benedict Cumberbatch), sends Proxima Midnight, and Corvus Glaive) to retrieve the Mind Stone from Vision (Paul Bettany). Meanwhile, Tony Stark (Robert Downey, Jr.) meets up with Bruce Banner (Mark Ruffalo) and sorcerers Doctor Strange (Benedict Cumberbatch) and Wong (Benedict Wong). With help from Peter Parker/Spider-Man (Tom Holland), Stark and Strange join forces together and agree to stop Thanos. In space, Thor (Chris Hemsworth) also joins forces with the Guardians of the Galaxy, Star-Lord (Chris Pratt), Drax (Dave Bautista), Rocket (Bradley Cooper), Groot (Vin Diesel), Mantis (Pom Klementieff), and Gamora (Zoe Saldana), the daughter of Thanos who warns Thor of his power. Thor travels away to defeat Thanos with Rocket and Groot, while the other Guardians join forces with Stark, Strange, and Parker. In Wakanda, Steve Rogers (Chris Evans) and his team, Black Widow (Scarlett Johansson), Falcon (Anthony Mackie), Scarlet Witch (Elizabeth Olsen), War Machine (Don Cheadle), and Bruce Banner to protect Vision and the Mind Stone in his forehead. With protection given from King T'Challa/Black Panther (Chadwick Boseman), and his Wakandan army, Thanos will come for everyone to destroy half the universe. kenamwilliam Two years after the Leipzig fight and immediately following the destruction of Asgard, the Avengers and the Guardians of the Galaxy learn that the Mad Titan Thanos is seeking to collect the Infinity Stones, which are said to be the most powerful artifacts in the universe. Facing an enemy too powerful to stop alone, the Avengers and the Guardians, alongside Doctor Strange, Black Panther, and Spider-Man must come together and stop Thanos from inflicting his power and destroying the universe. Blazer346 The mad titan Thanos has begun his quest to obtain all six Infinity Stones, which will give him the power to wipe out half of all life in the universe. Earth's mightiest heroes, now with help from the Guardians of the Galaxy, will be tested like never before in their efforts to fight against their most powerful threat to date. ahmetkozan</span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                               id="myCollapsibleBtn"
                                                      
                                                           role="button"
                                                       >
                                                        </a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BMjMxNjY2MDU1OV5BMl5BanBnXkFtZTgwNzY1MTUwNTM@.jpg"
                                             class="img-fluid rounded-start"
                                             alt="Avengers: Infinity War"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Durham, Durham, England, United Kingdom</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">54.776415</span>, <span class="lon">-1.575854</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Cockburn Street, Edinburgh, EH1 1BS, United Kingdom</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">55.950582</span>, <span class="lon">-3.1897533</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Banaue Rice Terraces, Banaue, Ifugao 3601, Philippines</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">16.955898</span>, <span class="lon">121.08789</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Lençois Maranhenses, Rua mandacaru, São Luís, Maranhão, Brazil</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">-2.499843</span>, <span class="lon">-44.250856</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Edinburgh, City Of Edinburgh, Scotland, United Kingdom</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">55.953346</span>, <span class="lon">-3.188375</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Inverness Castle, 41 Castle St., Inverness, Scotland IV2 3EG, United Kingdom</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">57.4762535</span>, <span class="lon">-4.225498</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">St Abb's Head, Eyemouth, Scotland TD14 5QF, United Kingdom</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">55.915688</span>, <span class="lon">-2.138515</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Royal Mile Cafe, Edinburgh, Scotland EH1 2NE, United Kingdom</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">55.94887</span>, <span class="lon">-3.196359</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">461 Sandy Creek Road, Fayetteville, Georgia 30214, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.474605</span>, <span class="lon">-84.510867</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Atlanta, Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.748992</span>, <span class="lon">-84.390264</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Marriott Vacation Club Pulse, 33 West 37th Street, New York, New York 10018, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">40.751296</span>, <span class="lon">-73.984819</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Tallulah Falls, Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.73065</span>, <span class="lon">-83.394332</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Atlanta, Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.748992</span>, <span class="lon">-84.390264</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">84 Walton St NW, Atlanta, Georgia 30303, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.75632</span>, <span class="lon">-84.39082</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Atlanta, Georgia, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.748992</span>, <span class="lon">-84.390264</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">103 Forsyth Street Northwest, Atlanta, Georgia 30303, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.755987</span>, <span class="lon">-84.390267</span></a>
                            </td>
                        </tr>
                    </tr>
            </table>
        </div>
    </div>
</main>
    <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>

<script type="text/javascript">
var locations =[{"bbox": [[33.474605, -84.510867], [33.748992, -84.390264], [33.748992, -84.390264]], "data": [{"lat": 54.776415, "lon": -1.575854, "name": "Durham, Durham, England, United Kingdom"}, {"lat": 55.950582, "lon": -3.1897533, "name": "Cockburn Street, Edinburgh, EH1 1BS, United Kingdom"}, {"lat": 16.955898, "lon": 121.08789, "name": "Banaue Rice Terraces, Banaue, Ifugao 3601, Philippines"}, {"lat": -2.499843, "lon": -44.250856, "name": "Len\u00e7ois Maranhenses, Rua mandacaru, S\u00e3o Lu\u00eds, Maranh\u00e3o, Brazil"}, {"lat": 55.953346, "lon": -3.188375, "name": "Edinburgh, City Of Edinburgh, Scotland, United Kingdom"}, {"lat": 57.4762535, "lon": -4.225498, "name": "Inverness Castle, 41 Castle St., Inverness, Scotland IV2 3EG, United Kingdom"}, {"lat": 55.915688, "lon": -2.138515, "name": "St Abb\u0027s Head, Eyemouth, Scotland TD14 5QF, United Kingdom"}, {"lat": 55.94887, "lon": -3.196359, "name": "Royal Mile Cafe, Edinburgh, Scotland EH1 2NE, United Kingdom"}, {"lat": 33.474605, "lon": -84.510867, "name": "461 Sandy Creek Road, Fayetteville, Georgia 30214, United States"}, {"lat": 33.748992, "lon": -84.390264, "name": "Atlanta, Georgia, United States"}, {"lat": 40.751296, "lon": -73.984819, "name": "Marriott Vacation Club Pulse, 33 West 37th Street, New York, New York 10018, United States"}, {"lat": 34.73065, "lon": -83.394332, "name": "Tallulah Falls, Georgia, United States"}, {"lat": 33.748992, "lon": -84.390264, "name": "Atlanta, Georgia, United States"}, {"lat": 33.75632, "lon": -84.39082, "name": "84 Walton St NW, Atlanta, Georgia 30303, United States"}, {"lat": 33.748992, "lon": -84.390264, "name": "Atlanta, Georgia, United States"}, {"lat": 33.755987, "lon": -84.390267, "name": "103 Forsyth Street Northwest, Atlanta, Georgia 30303, United States"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
    //console.log($(`${target} span`).first())

   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
</script>
</body>
</html>