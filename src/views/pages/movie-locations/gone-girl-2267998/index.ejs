<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">Gone Girl</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent"> With his wife's disappearance having become the focus of an intense media circus, a man sees the spotlight turned on him when it's suspected that he may not be innocent. On the occasion of his fifth wedding anniversary, Nick Dunne reports that his wife, Amy, has gone missing. Under pressure from the police and a growing media frenzy, Nick's portrait of a blissful union begins to crumble. Soon his lies, deceits and strange behavior have everyone asking the same dark question: Did Nick Dunne kill his wife? Twentieth Century Fox Nick Dunne, a small town guy who made good in the big city as a magazine writer blames the recession and the loss of his job for the decline of his marriage to his intellectually superior wife with a substantial trust ... </span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <span id="metaPlotContent"class="additional-information"> fund. Questions of his motives and character begin to arise after his wife's disappearance on the morning of their fifth anniversary. As the search for his missing wife plays out over the ensuing days, guilty suspicions are fueled into a national frenzy by the media circus camped outside his house. Is this idyllic, everyman truly capable of murdering his wife? MalcolmJTaylor Nick and Amy Dunne are a couple living in a small town in Missouri. Nick calls the authorities when she goes missing but something is off about his behavior. Is he hiding something? Is he sad or distraught enough? While the police continue their investigation, Nick is battling a media frenzy and the people who believe his innocence is dwindling by the minute. Angela Thomas A Missouri couple had a great life in their house with no kid, but it all changed when their 5th wedding anniversary occurs. Nick, the husband now realizes that his wife, Amy has gone missing. He calls the local authorities for reporting the situation. Along with the time and the local searching program, the progress becoming blurred between Nick's version of the story or the new investigation result - that Nick suspected of killing his wife. Now, Nick struggles for convincing the media, telling them if he didn't kill his wife, and probe the cryptic clues from his own wife. Gusde Under very curious and suspicious circumstances, the former New York City columnist, Nick Dunne, finds out that his home in Missouri has been intruded; his front door half-open; shattered glass everywhere, and his popular author wife, Amy, inexplicably missing. Amid an unbridled media feeding frenzy, inevitably, Nick's life comes under the spotlight, as the experienced detective, Rhonda Boney, delves deeper and deeper into the husband's seemingly perfect image. As a result, half-truths and full lies entangle Nick more and more in a foggy reality where nothing is what it seems. Is the caring family man, indeed, a cold-blooded murderer? Nick Riganas The disappearance of Nick Dunne's wife transpires into a media frenzy, leaving him frantic and in desperate need of a lawyer - but why? Darkly satirical and scintillating, Gone Girl forces us to look at the dark parts of ourselves, the validity of our relationships and society's propensity to pigeonhole women. BecksyKane </span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                           id="myCollapsibleBtn"
                                                           role="button"></a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BMTk0MDQ3MzAzOV5BMl5BanBnXkFtZTgwNzU1NzE3MjE@.jpg"
                                             class="img-fluid rounded-start"
                                             alt="Gone Girl"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Cape Girardeau, Missouri, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.303493</span>, <span class="lon">-89.523036</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Grant, Colorado, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">39.439127</span>, <span class="lon">-105.611502</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">119 Themis Street, Cape Girardeau, Missouri 63701, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.3048</span>, <span class="lon">-89.51922</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">453 North Spring Street, Compton, California 90221, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.89881</span>, <span class="lon">-118.218128</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">44 North Lorimier Street, Cape Girardeau, Missouri 63701, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.30499</span>, <span class="lon">-89.520203</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Keystone Drive, Cape Girardeau, Missouri 63701, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.32527</span>, <span class="lon">-89.5754</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Elm Street, Cape Girardeau, Missouri 63703, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.291655</span>, <span class="lon">-89.529735</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">2901 Hawthorne Road, Cape Girardeau, Missouri 63701, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.31807</span>, <span class="lon">-89.567705</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Hawthorne, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">33.918859</span>, <span class="lon">-118.348326</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">104 Fremont Place, Los Angeles, California 90005, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.0598</span>, <span class="lon">-118.32821</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Marriott Vacation Club Pulse, 33 West 37th Street, New York, New York 10018, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">40.751296</span>, <span class="lon">-73.984819</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Albert Rasche Drive, Cape Girardeau, Missouri 63701, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.33037</span>, <span class="lon">-89.55543</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Universal City Plz, Universal City, California 91608, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.1379</span>, <span class="lon">-118.3613</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Los Angeles, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.053691</span>, <span class="lon">-118.242766</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Big Lots, 9008 Foothill Blvd, Rancho Cucamonga, California 91730, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.108073</span>, <span class="lon">-117.608721</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">846 North Cahuenga Boulevard, Los Angeles, California 90038, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.08662</span>, <span class="lon">-118.32862</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Burbank, California, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">34.181648</span>, <span class="lon">-118.325855</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">460 Giant City Lodge, Makanda, Illinois 62958, United States</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">37.60586</span>, <span class="lon">-89.1865</span></a>
                            </td>
                        </tr>
                    </table>
            </div>
        </main>
        <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>
        <script type="text/javascript">
var locations =[{"bbox": [[33.89881, -118.218128], [33.918859, -118.348326], [34.053691, -118.242766]], "data": [{"lat": 37.303493, "lon": -89.523036, "name": "Cape Girardeau, Missouri, United States"}, {"lat": 39.439127, "lon": -105.611502, "name": "Grant, Colorado, United States"}, {"lat": 37.3048, "lon": -89.51922, "name": "119 Themis Street, Cape Girardeau, Missouri 63701, United States"}, {"lat": 33.89881, "lon": -118.218128, "name": "453 North Spring Street, Compton, California 90221, United States"}, {"lat": 37.30499, "lon": -89.520203, "name": "44 North Lorimier Street, Cape Girardeau, Missouri 63701, United States"}, {"lat": 37.32527, "lon": -89.5754, "name": "Keystone Drive, Cape Girardeau, Missouri 63701, United States"}, {"lat": 37.291655, "lon": -89.529735, "name": "Elm Street, Cape Girardeau, Missouri 63703, United States"}, {"lat": 37.31807, "lon": -89.567705, "name": "2901 Hawthorne Road, Cape Girardeau, Missouri 63701, United States"}, {"lat": 33.918859, "lon": -118.348326, "name": "Hawthorne, California, United States"}, {"lat": 34.0598, "lon": -118.32821, "name": "104 Fremont Place, Los Angeles, California 90005, United States"}, {"lat": 40.751296, "lon": -73.984819, "name": "Marriott Vacation Club Pulse, 33 West 37th Street, New York, New York 10018, United States"}, {"lat": 37.33037, "lon": -89.55543, "name": "Albert Rasche Drive, Cape Girardeau, Missouri 63701, United States"}, {"lat": 34.1379, "lon": -118.3613, "name": "Universal City Plz, Universal City, California 91608, United States"}, {"lat": 34.053691, "lon": -118.242766, "name": "Los Angeles, California, United States"}, {"lat": 34.108073, "lon": -117.608721, "name": "Big Lots, 9008 Foothill Blvd, Rancho Cucamonga, California 91730, United States"}, {"lat": 34.08662, "lon": -118.32862, "name": "846 North Cahuenga Boulevard, Los Angeles, California 90038, United States"}, {"lat": 34.181648, "lon": -118.325855, "name": "Burbank, California, United States"}, {"lat": 37.60586, "lon": -89.1865, "name": "460 Giant City Lodge, Makanda, Illinois 62958, United States"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                          
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
        </script>
    </body>
</html>