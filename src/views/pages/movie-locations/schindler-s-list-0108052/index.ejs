<!DOCTYPE html>
<html lang="en" dir="ltr">
    <%- include(`${partials}/movieLocationHead.ejs`, {pageTitle: 'Film Locations'}); -%>
    <body class="film-location film-details">
        <!--[if lt IE 8]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="http://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </p>
<![endif]-->
        <noscript>
            <h3>Please enable JavaScript in order to view this site properly.</h3>
        </noscript>
        <%- include(`${partials}/nav`); -%>
        <main class="mb-4 mt-5">
            <div class="container px-4 px-lg-5">
                     <%- include(`${partials}/autocomplete`); -%>
                <div class="row align-items-md-stretch">
                    <div class="col-md-12">
                        <div class="card mb-3" id="film-details">
                            <div class="row g-0">
                                <div class="col-md-8 px-3 py-3">
                                    <div class="card-body">
                                        <h3 class="card-title">Schindler's List</h3>
                                        <p class="card-text mb-0">
                                            <span id="mainPlotContent">In German-occupied Poland during World War II, industrialist Oskar Schindler gradually becomes concerned for his Jewish workforce after witnessing their persecution by the Nazis. Oskar Schindler is a vain and greedy German businessman who becomes an unlikely humanitarian amid the barbaric German Nazi reign when he feels compelled to turn his factory into a refuge for Jews. Based on the true story of Oskar Schindler who managed to save about 1100 Jews from being gassed at the Auschwitz concentration camp, it is a testament to the good in all of us. Harald Mayr <marvin@bike.augusta.de> The incredible true story of the enigmatic and opportunistic businessman Oskar Schindler, who saved the lives of more than 1,100 Jews during the Holocaust. Sch...</span>
                                                
                                                    <div class="collapse" id="movieLocationCollapsible">
                                                        <div id = "module"></div>
                                                        <span id="metaPlotContent"class="additional-information">indler's List chronicles the trials and triumph of one man who made a difference and the tribulations of those who survived one of the darkest chapters in human history because of his actions. Spiricom Businessman Oskar Schindler arrives in Krakow in 1939, ready to make his fortune from World War II, which has just started. After joining the Nazi party primarily for political expediency, he staffs his factory with Jewish workers for similarly pragmatic reasons. When the SS begins exterminating Jews in the Krakow ghetto, Schindler arranges to have his workers protected to keep his factory in operation, but soon realizes that in so doing, he is also saving innocent lives. Jwelch5742 The true story of Czech born Oskar Schindler, a businessman who tried to make his fortune during the Second World War by exploiting cheap Jewish labour, but ended up penniless having saved over 1000 Polish Jews from almost certain death during the Holocaust. Rob Hartill  Schindler's List  is the based-on-truth story of Nazi Czech business man Oskar Schindler, who uses Jewish labor to start a factory in occupied Poland. As World War II progresses, and the fate of the Jews becomes more and more clear, Schindler's motivations switch from profit to human sympathy and he is able to save over 1100 Jews from death in the gas chambers. Anthony Hughes <husnock31@hotmail.com></span>
                                                    </div>
                                                    <p>
                                                        <a class="btn btn-link show-more-less collapsed"
                                                               id="myCollapsibleBtn"
                                                      
                                                           role="button"
                                                       >
                                                        </a>
                                                    </p>
                                                
                                            </p>
                                    </div>
                                </div>
                                <div class="col-md-4 justify-self-end">
                                        <img src="https://m.media-amazon.com/images/M/MV5BNDE4OTMxMTctNmRhYy00NWE2LTg3YzItYTk3M2UwOTU5Njg4XkEyXkFqcGdeQXVyNjU0OTQ0OTY@.jpg"
                                             class="img-fluid rounded-start"
                                             alt="Schindler's List"/>
                                    </div>
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="map-container">
                        <div id="map"></div>
                        <div id="loader">
                            <div class="spinner-border" role="status">
                                <span class="sr-only d-none">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <tr class="table__header">
                        <th class="table__cell">Location</th>
                        <th class="table__cell">Coordiantes</th>
                    </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Oświęcim, Powiat Oświęcimski, Lesser Poland Voivodeship, Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">50.03333</span>, <span class="lon">19.23333</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Józefa Piłsudskiego, 32-050 Skawina, Lesser Poland Voivodeship, Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">49.9697823</span>, <span class="lon">19.79891515</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Łaszów, Powiat Proszowicki, Lesser Poland Voivodeship, Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">50.281</span>, <span class="lon">20.339</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Szeroka, 31-053 Kraków, Lesser Poland Voivodeship, Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">50.0522796</span>, <span class="lon">19.9479472</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Kraków, Lesser Poland Voivodeship, Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">50.06667</span>, <span class="lon">19.95</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Józefa, 31-056 Kraków, Lesser Poland Voivodeship, Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">50.0508913</span>, <span class="lon">19.9454068</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Jerusalem, Jerusalem District, Israel</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">31.77331512</span>, <span class="lon">35.18679028</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Poland</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">52.1246099075455</span>, <span class="lon">19.30063630556</span></a>
                            </td>
                        </tr>
                    <tr class="table__row">
                            <td class="table__cell">
                                <a href="#">Israel</a>
                            </td>
                            <td class="table__cell">
                                <a href="#"><span class="lat">31.8472608144505</span>, <span class="lon">34.8419985253627</span></a>
                            </td>
                        </tr>
                    </tr>
            </table>
        </div>
    </div>
</main>
    <%- include(`${partials}/footer`); -%> <%- include(`${partials}/page-scripts/movie-location-scripts`); -%>

<script type="text/javascript">
var locations =[{"bbox": [[49.9697823, 19.79891515], [50.03333, 19.23333], [50.0508913, 19.9454068]], "data": [{"lat": 50.03333, "lon": 19.23333, "name": "O\u015bwi\u0119cim, Powiat O\u015bwi\u0119cimski, Lesser Poland Voivodeship, Poland"}, {"lat": 49.9697823, "lon": 19.79891515, "name": "J\u00f3zefa Pi\u0142sudskiego, 32-050 Skawina, Lesser Poland Voivodeship, Poland"}, {"lat": 50.281, "lon": 20.339, "name": "\u0141asz\u00f3w, Powiat Proszowicki, Lesser Poland Voivodeship, Poland"}, {"lat": 50.0522796, "lon": 19.9479472, "name": "Szeroka, 31-053 Krak\u00f3w, Lesser Poland Voivodeship, Poland"}, {"lat": 50.06667, "lon": 19.95, "name": "Krak\u00f3w, Lesser Poland Voivodeship, Poland"}, {"lat": 50.0508913, "lon": 19.9454068, "name": "J\u00f3zefa, 31-056 Krak\u00f3w, Lesser Poland Voivodeship, Poland"}, {"lat": 31.77331512, "lon": 35.18679028, "name": "Jerusalem, Jerusalem District, Israel"}, {"lat": 52.1246099075455, "lon": 19.30063630556, "name": "Poland"}, {"lat": 31.8472608144505, "lon": 34.8419985253627, "name": "Israel"}]}];
var map = L.map('map').setView([0,0], 20);

const layer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
})


let locationData = locations[0].data
let tableCell = document.querySelectorAll('.table__cell a')

tableCell.forEach(box => {
  box.addEventListener('click', function handleClick(event) {
    event.preventDefault()
    let target = event.target
    //console.log($(`${target} span`).first())

   let boxChildren = $(this).children()
   if(boxChildren.length < 1 ){
const found = locationData.find(element => element.name == target.innerText);

    let lat = found.lat
    let lon = found.lon
    let name = found.name
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');

   } else {

     let first = $(this).children().first().text()
     let second = $(this).children().last().text()
     let lat = parseFloat(first)
     let lon = parseFloat(second)
     console.log(lat,lon)
   map.flyTo([lat, lon])

    $('html,body').animate({                                                          //  fine in moz, still quicker in chrome.
        scrollTop: $("#map").offset().top},
        'slow');
   }


});
});



const coords = []
    for (let index = 0; index < locations[0].data.length; index++) {
  const element = locations[0].data[index];
 coords.push([element.lat, element.lon])

  let marker = L.marker([element.lat, element.lon]);
  marker.bindPopup(element.name);
marker.addTo(map);

}

if(locations[0].bbox){

const box = locations[0].bbox
  console.log(JSON.stringify(box))
  map.fitBounds(box)
map.zoomOut(1);
}
else if (!locations[0].bbox){

  console.log('no box')
  console.log(locations[0].data[0].lat)
  let lat = locations[0].data[0].lat
  let lon = locations[0].data[0].lon
map.setView([lat, lon], 20);
}
layer.on('load', function (event) {
     document.getElementById('loader').classList.add('d-none')



});
layer.addTo(map);
</script>
</body>
</html>